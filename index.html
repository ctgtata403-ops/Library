<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶Ü‡¶Ø‡¶º ‡¶¨‡ßç‡¶Ø‡¶Ø‡¶º ‡¶™‡ßç‡¶∞‡ßã</title>
    <link href="https://fonts.googleapis.com/css2?family=Anek+Bangla:wght@300;400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root { 
            --primary: #2196F3; --income: #4CAF50; --expense: #F44336; 
            --bg: #F8F9FA; --card-bg: #ffffff; --text: #333333; --border: #eeeeee;
        }

        body.dark-mode {
            --bg: #121212; --card-bg: #1e1e1e; --text: #e0e0e0; --border: #333333;
        }

        body { font-family: 'Anek Bangla', sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 0; transition: 0.3s; }
        .app-container { width: 100%; max-width: 450px; background: var(--card-bg); min-height: 100vh; margin: auto; position: relative; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        
        header { padding: 15px 20px; background: var(--card-bg); border-bottom: 1px solid var(--border); position: sticky; top: 0; z-index: 100; }
        .logo-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .logo { color: var(--primary); font-size: 20px; font-weight: 700; }
        
        #searchInput { width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: 8px; font-family: 'Anek Bangla'; outline: none; background: var(--bg); color: var(--text); box-sizing: border-box; }

        .period-box { background: var(--bg); padding: 4px; border-radius: 10px; display: flex; border: 1px solid var(--border); margin: 10px 20px; }
        .period-btn { flex: 1; padding: 8px; border: none; background: transparent; font-family: 'Anek Bangla'; font-weight: 700; cursor: pointer; border-radius: 8px; color: var(--text); }
        .period-btn.active { background: var(--primary); color: #fff; }

        .summary-card { margin: 10px 15px; padding: 15px; border-radius: 15px; border: 1px solid var(--border); display: grid; grid-template-columns: 1fr 1fr 1fr; text-align: center; }
        .summary-item h4 { margin: 0; font-size: 12px; color: #888; }
        .summary-item p { margin: 5px 0 0; font-weight: 700; font-size: 14px; }

        .cat-chip { padding: 6px 15px; background: var(--bg); border-radius: 20px; font-size: 13px; white-space: nowrap; cursor: pointer; border: 1px solid var(--border); color: var(--text); }
        .cat-chip.active { background: var(--primary); color: #fff; border-color: var(--primary); }

        .item { padding: 12px 10px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
        .item small { color: #888; display: block; }

        .fab { position: fixed; bottom: 25px; right: 20px; width: 55px; height: 55px; background: var(--primary); color: #fff; border-radius: 50%; border: none; font-size: 30px; box-shadow: 0 4px 10px rgba(0,0,0,0.2); cursor: pointer; z-index: 90; }

        .screen { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--card-bg); z-index: 1000; overflow-y: auto; }
        .screen-header { padding: 15px 20px; display: flex; align-items: center; gap: 15px; border-bottom: 1px solid var(--border); background: var(--card-bg); position: sticky; top: 0; }

        .profile-card { background: var(--bg); margin: 20px; padding: 25px 20px; border-radius: 20px; border: 1px solid var(--border); display: flex; flex-direction: column; align-items: center; text-align: center; }
        .profile-img { width: 90px; height: 90px; border-radius: 50%; border: 3px solid var(--primary); object-fit: cover; margin-bottom: 15px; }
        
        .settings-card { background: var(--bg); margin: 10px 20px; padding: 15px; border-radius: 15px; text-align: center; border: 1px solid var(--border); }
        .download-btn { background: var(--primary); color: white; border: none; padding: 8px 15px; border-radius: 8px; font-family: 'Anek Bangla'; font-weight: 600; cursor: pointer; margin-top: 10px; font-size: 13px; flex: 1; }

        .setting-row { display: flex; justify-content: space-between; align-items: center; padding: 18px 20px; border-bottom: 1px solid var(--border); cursor: pointer; text-decoration: none; color: inherit; }
        
        .switch { position: relative; display: inline-block; width: 45px; height: 24px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 24px; }
        .slider:before { position: absolute; content: ""; height: 18px; width: 18px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: var(--primary); }
        input:checked + .slider:before { transform: translateX(21px); }

        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 1100; }
        .modal-content { background: var(--card-bg); width: 85%; max-width: 350px; margin: 80px auto; border-radius: 20px; padding: 25px; color: var(--text); }
        .type-toggle { display: flex; background: var(--bg); border-radius: 10px; padding: 4px; margin-bottom: 20px; }
        .type-btn { flex: 1; padding: 10px; text-align: center; cursor: pointer; border-radius: 8px; font-weight: 700; color: #888; }
        .active-inc { background: var(--income) !important; color: white !important; }
        .active-exp { background: var(--expense) !important; color: white !important; }

        input, select { width: 100%; padding: 12px; margin-bottom: 12px; border: 1px solid var(--border); border-radius: 8px; font-family: 'Anek Bangla'; background: var(--bg); color: var(--text); box-sizing: border-box; }
        .btn-save { width: 100%; padding: 12px; background: var(--primary); color: #fff; border: none; border-radius: 8px; font-weight: 700; cursor: pointer; font-size: 16px; }
    </style>
</head>
<body>

<div class="app-container">
    <header>
        <div class="logo-row">
            <div class="logo">‚ö° ‡¶Ü‡¶Ø‡¶º ‡¶¨‡ßç‡¶Ø‡¶Ø‡¶º ‡¶™‡ßç‡¶∞‡ßã</div>
            <div style="display:flex; gap:18px">
                <span onclick="openCatScreen()" style="cursor:pointer; font-size: 20px;">üìÅ</span>
                <span onclick="openSettings()" style="cursor:pointer; font-size: 20px;">‚öôÔ∏è</span>
            </div>
        </div>
        <input type="text" id="searchInput" placeholder="‡¶∏‡¶æ‡¶∞‡ßç‡¶ö ‡¶ï‡¶∞‡ßÅ‡¶®..." oninput="renderMain()">
    </header>

    <div class="period-box">
        <button id="btn-month" class="period-btn active" onclick="setPeriod('month')">‡¶ú‡¶æ‡¶®‡ßÅ‡ßü‡¶æ‡¶∞‡¶ø</button>
        <button id="btn-all" class="period-btn" onclick="setPeriod('all')">‡¶Æ‡ßã‡¶ü</button>
    </div>

    <div class="summary-card">
        <div class="summary-item"><h4>‡¶Ü‡¶Ø‡¶º</h4><p style="color:var(--income)">‡ß≥ <span id="top-inc">‡ß¶</span></p></div>
        <div class="summary-item"><h4>‡¶¨‡ßç‡¶Ø‡¶Ø‡¶º</h4><p style="color:var(--expense)">‡ß≥ <span id="top-exp">‡ß¶</span></p></div>
        <div class="summary-item"><h4>‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏</h4><p id="top-bal" style="color:var(--primary)">‡ß≥ ‡ß¶</p></div>
    </div>

    <div style="display: flex; overflow-x: auto; gap: 8px; padding: 10px 20px;" id="cat-chips"></div>
    <div style="padding: 0 15px 100px;" id="main-list"></div>
    <button class="fab" onclick="openAddModal()">+</button>
</div>

<div id="settingsScreen" class="screen">
    <div class="screen-header">
        <span onclick="closeSettings()" style="cursor:pointer; font-size: 20px;">‚Üê</span>
        <strong style="font-size: 18px;">‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏</strong>
    </div>

    <div class="profile-card">
        <img src="https://maruf.lovestoblog.com/wp-content/uploads/2026/01/1000102487-edited-768x768.jpg" alt="Maruf" class="profile-img">
        <h2 class="profile-name">‡¶Æ‡¶ú‡ßÅ‡¶Æ‡¶¶‡¶æ‡¶∞ ‡¶Æ‡ßã. ‡¶Æ‡¶æ‡¶∞‡ßÅ‡¶´</h2>
        <div class="profile-edu">‡¶∞‡ßá‡¶°‡¶ø‡¶ì‡¶ó‡ßç‡¶∞‡¶æ‡¶´‡¶ø, ‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶¨‡¶∞‡ßç‡¶∑<br>‡¶ö‡¶ü‡ßç‡¶ü‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶∏‡¶∞‡¶ï‡¶æ‡¶∞‡¶ø ‡¶Ü‡¶á‡¶è‡¶ö‡¶ü‡¶ø</div>
    </div>

    <div class="settings-card">
        <div style="color: var(--primary); font-size: 13px; margin-bottom: 5px;">üìä ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®</div>
        <div style="display: flex; gap: 10px; padding: 5px;">
            <button class="download-btn" onclick="downloadReport('month')">üìÖ ‡¶è‡¶á ‡¶Æ‡¶æ‡¶∏</button>
            <button class="download-btn" style="background:#607D8B" onclick="downloadReport('year')">üóìÔ∏è ‡¶è‡¶á ‡¶¨‡¶õ‡¶∞</button>
        </div>
    </div>

    <div class="setting-row">
        <div style="display:flex; align-items:center; gap:15px; font-weight:600;"><span>üåô</span> <span>‡¶°‡¶æ‡¶∞‡ßç‡¶ï ‡¶Æ‡ßã‡¶°</span></div>
        <label class="switch">
            <input type="checkbox" id="darkModeToggle" onclick="toggleDarkMode()">
            <span class="slider"></span>
        </label>
    </div>
    
    <a href="https://www.facebook.com/mazumder.md.maruf" target="_blank" class="setting-row">
        <div style="display:flex; align-items:center; gap:15px; font-weight:600;"><span>üì±</span> <span>‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó (Facebook)</span></div>
        <span>üîó</span>
    </a>
    
    <div style="padding: 20px; color: #888; font-size: 12px; text-align: center;">‡¶≠‡¶æ‡¶∞‡ßç‡¶∏‡¶® ‡ßß.‡ß®.‡ßß</div>
</div>

<div class="modal" id="addModal">
    <div class="modal-content">
        <h3 style="margin:0 0 20px; text-align:center">‡¶®‡¶§‡ßÅ‡¶® ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨</h3>
        <div class="type-toggle">
            <div id="toggle-inc" class="type-btn" onclick="setAddType('income')">‡¶Ü‡¶Ø‡¶º</div>
            <div id="toggle-exp" class="type-btn active-exp" onclick="setAddType('expense')">‡¶¨‡ßç‡¶Ø‡¶Ø‡¶º</div>
        </div>
        <select id="modal-cat"></select>
        <input type="number" id="modal-amount" placeholder="‡¶ü‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£">
        <input type="text" id="modal-note" placeholder="‡¶¨‡¶ø‡¶¨‡¶∞‡¶£ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®">
        <button class="btn-save" onclick="saveTransaction()">‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        <p onclick="closeModal()" style="text-align:center; color:#888; cursor:pointer; margin-top:15px;">‡¶¨‡¶æ‡¶§‡¶ø‡¶≤</p>
    </div>
</div>

<div id="catScreen" class="screen">
    <div class="screen-header"><span onclick="closeCatScreen()" style="cursor:pointer; font-size: 20px;">‚Üê</span><strong>‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø</strong></div>
    <div style="padding: 20px;"><input type="text" id="newCatInput" placeholder="‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø..."><button class="btn-save" onclick="addCategory()">‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</button><div id="cat-list-container" style="margin-top:20px;"></div></div>
</div>

<script>
    let db = { transactions: [], categories: ['‡¶∏‡¶¨', '‡¶®‡¶æ‡¶∏‡ßç‡¶§‡¶æ', '‡¶¨‡ßá‡¶§‡¶®', '‡¶¨‡¶æ‡¶ú‡¶æ‡¶∞'], darkMode: false };
    try { const saved = localStorage.getItem('aybey_pro_v19'); if(saved) db = JSON.parse(saved); } catch(e) {}
    
    let activePeriod = 'month', activeCat = '‡¶∏‡¶¨', currentAddType = 'expense';

    function toggleDarkMode() { db.darkMode = document.getElementById('darkModeToggle').checked; applyDarkMode(); saveData(); }
    function applyDarkMode() {
        if(db.darkMode) { document.body.classList.add('dark-mode'); document.getElementById('darkModeToggle').checked = true; } 
        else { document.body.classList.remove('dark-mode'); document.getElementById('darkModeToggle').checked = false; }
    }

    function openSettings() { document.getElementById('settingsScreen').style.display = 'block'; }
    function closeSettings() { document.getElementById('settingsScreen').style.display = 'none'; }
    function openCatScreen() { document.getElementById('catScreen').style.display = 'block'; renderCatList(); }
    function closeCatScreen() { document.getElementById('catScreen').style.display = 'none'; }
    function openAddModal() { document.getElementById('modal-cat').innerHTML = db.categories.filter(c => c !== '‡¶∏‡¶¨').map(c => `<option value="${c}">${c}</option>`).join(''); document.getElementById('addModal').style.display = 'block'; }
    function closeModal() { document.getElementById('addModal').style.display = 'none'; }

    function setAddType(type) {
        currentAddType = type;
        document.getElementById('toggle-inc').className = type === 'income' ? 'type-btn active-inc' : 'type-btn';
        document.getElementById('toggle-exp').className = type === 'expense' ? 'type-btn active-exp' : 'type-btn';
    }

    function saveTransaction() {
        const amt = parseFloat(document.getElementById('modal-amount').value); if(!amt) return;
        db.transactions.unshift({ type: currentAddType, cat: document.getElementById('modal-cat').value, amount: amt, note: document.getElementById('modal-note').value || (currentAddType==='income'?'‡¶Ü‡ßü':'‡¶¨‡ßç‡¶Ø‡ßü'), date: new Date().toISOString() });
        saveData(); closeModal(); renderMain();
        document.getElementById('modal-amount').value = ''; document.getElementById('modal-note').value = '';
    }

    // ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
    function downloadReport(period) {
        const now = new Date();
        const filtered = db.transactions.filter(t => {
            const d = new Date(t.date);
            if(period === 'month') return d.getMonth() === now.getMonth() && d.getFullYear() === now.getFullYear();
            if(period === 'year') return d.getFullYear() === now.getFullYear();
            return true;
        });

        if(filtered.length === 0) { alert("‡¶ï‡ßã‡¶®‡ßã ‡¶°‡¶æ‡¶ü‡¶æ ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø!"); return; }

        const data = filtered.map(t => ({
            '‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ': new Date(t.date).toLocaleDateString('bn-BD'),
            '‡¶¨‡¶ø‡¶¨‡¶∞‡¶£': t.note,
            '‡¶ï‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶ó‡¶∞‡¶ø': t.cat,
            '‡¶ß‡¶∞‡¶£': t.type === 'income' ? '‡¶Ü‡¶Ø‡¶º' : '‡¶¨‡ßç‡¶Ø‡¶Ø‡¶º',
            '‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ (‡ß≥)': t.amount
        }));

        const ws = XLSX.utils.json_to_sheet(data);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "‡¶π‡¶ø‡¶∏‡¶æ‡¶¨");
        const name = period === 'month' ? `Monthly_Report_${now.getMonth()+1}.xlsx` : `Yearly_Report_${now.getFullYear()}.xlsx`;
        XLSX.writeFile(wb, name);
    }

    function addCategory() {
        const val = document.getElementById('newCatInput').value.trim();
        if(val && !db.categories.includes(val)) { db.categories.push(val); saveData(); renderCatList(); renderCats(); document.getElementById('newCatInput').value = ''; }
    }
    function renderCatList() { document.getElementById('cat-list-container').innerHTML = db.categories.filter(c => c !== '‡¶∏‡¶¨').map(c => `<div style="display:flex; justify-content:space-between; padding:12px; border-bottom:1px solid var(--border);"><span>${c}</span><span onclick="deleteCat('${c}')" style="color:red; cursor:pointer">‡¶Æ‡ßÅ‡¶õ‡ßÅ‡¶®</span></div>`).join(''); }
    function deleteCat(c) { db.categories = db.categories.filter(cat => cat !== c); saveData(); renderCatList(); renderCats(); }
    function saveData() { localStorage.setItem('aybey_pro_v19', JSON.stringify(db)); }

    function setPeriod(p) { activePeriod = p; document.getElementById('btn-month').classList.toggle('active', p === 'month'); document.getElementById('btn-all').classList.toggle('active', p === 'all'); renderMain(); }
    function renderCats() { document.getElementById('cat-chips').innerHTML = db.categories.map(c => `<div class="cat-chip ${activeCat === c ? 'active' : ''}" onclick="activeCat='${c}';renderCats();renderMain();">${c}</div>`).join(''); }

    function renderMain() {
        const list = document.getElementById('main-list'); const search = document.getElementById('searchInput').value.toLowerCase();
        list.innerHTML = ''; let inc = 0, exp = 0; const now = new Date();
        db.transactions.filter(t => { const d = new Date(t.date); return (t.note.toLowerCase().includes(search) || t.cat.toLowerCase().includes(search)) && (activeCat === '‡¶∏‡¶¨' || t.cat === activeCat) && (activePeriod === 'all' || d.getMonth() === now.getMonth()); }).forEach(t => {
            if(t.type === 'income') inc += t.amount; else exp += t.amount;
            list.innerHTML += `<div class="item"><div><strong>${t.note}</strong><small>${t.cat} ‚Ä¢ ${new Date(t.date).toLocaleDateString('bn-BD')}</small></div><span style="color:${t.type==='income'?'var(--income)':'var(--expense)'}; font-weight:700">${t.type==='income'?'+':'-'} ‡ß≥${t.amount.toLocaleString('bn-BD')}</span></div>`;
        });
        document.getElementById('top-inc').innerText = inc.toLocaleString('bn-BD'); document.getElementById('top-exp').innerText = exp.toLocaleString('bn-BD');
        document.getElementById('top-bal').innerText = '‡ß≥ ' + (inc - exp).toLocaleString('bn-BD');
    }

    applyDarkMode(); renderCats(); renderMain();
</script>
</body>
</html>